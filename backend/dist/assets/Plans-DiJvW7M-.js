import{r as h,u as b,y as t,a as w,j as r}from"./index-BLoMeHUS.js";import{a as f}from"./index-D8rVyQy1.js";const y=()=>{const[e,d]=h.useState(null),[u,o]=h.useState(!1),{user:l,dispatch:c}=b();return{upgrade:async(i,g)=>{var s,n,m,p;if(!navigator.onLine)return t.error("No internet connection! Please check your network");o(!0),d(null);try{const a=await f.patch(`https://workoutx-e9dl.onrender.com/api/user/upgrade/${i}`,{plan:g},{headers:{Authorization:`Bearer ${l.token}`}});if(a.data){const x={_id:a.data._id,fullName:a.data.fullName,username:a.data.username,email:a.data.email,token:a.data.token,plan:a.data.plan};localStorage.setItem("user",JSON.stringify(x)),c({type:"UPGRADE",payload:x}),t.success(a.data.message||"Upgraded to Premium account")}else t.error("Upgrade failed: No user data returned.");d(null)}catch(a){t.success(((n=(s=a.response)==null?void 0:s.data)==null?void 0:n.message)||"Failed to upgrade to Premium account"),d(((p=(m=a.response)==null?void 0:m.data)==null?void 0:p.message)||"Failed to upgrade to Premium account")}finally{o(!1)}},UpgradeError:e,UpgradeIsLoading:u}},N=()=>{const[e,d]=h.useState(null),[u,o]=h.useState(!1),{user:l,dispatch:c}=b();return{downgrade:async(i,g)=>{var s,n,m,p;if(!navigator.onLine)return t.error("No internet connection! Please check your network");o(!0),d(null);try{const a=await f.patch(`https://workoutx-e9dl.onrender.com/api/user/downgrade/${i}`,{plan:g},{headers:{Authorization:`Bearer ${l.token}`}});if(a.data){const x={_id:a.data._id,fullName:a.data.fullName,username:a.data.username,email:a.data.email,token:a.data.token,plan:a.data.plan};localStorage.setItem("user",JSON.stringify(x)),c({type:"DOWNGRADE",payload:x}),t.success(a.data.message||"Downgraded to Basic account")}else t.error("Downgrade failed: No user data returned.");d(null)}catch(a){t.success(((n=(s=a.response)==null?void 0:s.data)==null?void 0:n.message)||"Failed to downgrade to Basic account"),d(((p=(m=a.response)==null?void 0:m.data)==null?void 0:p.message)||"Failed to downgrade to Basic account")}finally{o(!1)}},downgradeError:e,downgradeIsLoading:u}},B=()=>{const{user:e}=b(),d=w(),{downgrade:u,downgradeError:o,downgradeIsLoading:l}=N(),{upgrade:c,upgradeError:k,upgradeIsLoading:i}=y(),g=async n=>{if(n.preventDefault(),!e){t.error("Please log in to upgrade");return}if(e.plan==="Premium"){t.error("You're already on the Premium plan");return}await c(e._id,"Premium"),d("/")},s=async n=>{if(n.preventDefault(),!e){t.error("Please log in to downgrade");return}if(e.plan==="Basic"){t.error("You're already on the Basic plan");return}await u(e._id,"Basic"),d("/")};return r.jsxs("div",{className:"w-full flex flex-col items-center justify-center bg-neutral-200 text-blue-900 dark:bg-darkPrimary dark:text-white relative",children:[r.jsx("button",{className:"text-white absolute top-5 left-5 cursor-pointer bg-blue-900 hover:bg-blue-950 dark:bg-darkTertiary dark:hover:bg-darkSecondary rounded-lg p-2",onClick:()=>{d("/")},children:"Back"}),r.jsx("h1",{className:"text-3xl font-bold mb-8 dark:text-darkTextPrimary",children:"Choose Your Plan"}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 min-w-md sm:max-w-5xl gap-8",children:[r.jsxs("div",{className:"bg-neutral-300 hover:scale-105 duration-500 ease-in-out transition-transform dark:bg-darkTertiary p-8 m-2 rounded-lg shadow-lg flex flex-col items-center",children:[r.jsx("h2",{className:"text-2xl font-bold mb-2 text-neutral-800 dark:text-darkTextPrimary",children:"Basic Plan"}),r.jsx("p",{className:"text-neutral-700 dark:text-darkTextResult",children:"Access limited features"}),r.jsx("button",{onClick:s,disabled:l||e.plan==="Basic",className:`px-5 py-2 mt-4 rounded-lg text-white transition-all duration-300 ${(e==null?void 0:e.plan)==="Basic"?"bg-neutral-700 dark:bg-darkDisabledButton dark:text-darkDisabledText cursor-not-allowed":"bg-blue-500 px-5 py-2 mt-4 rounded-lg hover:bg-blue-600 dark:bg-darkAddButton dark:hover:bg-darkAddButtonHover dark:active:bg-darkAddButton cursor-pointer"}`,children:(e==null?void 0:e.plan)==="Basic"?"Active":l?"Updating...":"Switch back to Basic"}),o&&r.jsx("p",{className:"text-red-500",children:o})]}),r.jsxs("div",{className:"bg-neutral-300 hover:scale-105 duration-500 ease-in-out transition-transform dark:bg-darkTertiary p-8 m-2 rounded-lg shadow-lg flex flex-col items-center",children:[r.jsx("h2",{className:"text-2xl font-bold mb-2 text-neutral-800  dark:text-darkTextPrimary",children:"Premium Plan"}),r.jsx("p",{className:"text-neutral-700 dark:text-darkTextResult",children:"Unlock workout status feature"}),r.jsx("button",{onClick:g,disabled:i||e.plan==="Premium",className:`px-5 py-2 mt-4 rounded-lg text-white transition-all duration-300 ${(e==null?void 0:e.plan)==="Premium"?"bg-neutral-700 dark:bg-darkDisabledButton dark:text-darkDisabledText cursor-not-allowed":"bg-blue-500 px-5 py-2 mt-4 rounded-lg hover:bg-blue-600 dark:bg-darkAddButton dark:hover:bg-darkAddButtonHover dark:active:bg-darkAddButton cursor-pointer"}`,children:(e==null?void 0:e.plan)==="Premium"?"Active":i?"Upgrading...":"Upgrade to Premium"}),k&&r.jsx("p",{className:"text-red-500",children:k})]})]})]})};export{B as default};
