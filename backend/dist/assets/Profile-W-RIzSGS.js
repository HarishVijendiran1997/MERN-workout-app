import{r,u as b,y as k,a as f,j as e}from"./index-BLoMeHUS.js";import{F as S}from"./index-BH8Fojpr.js";import{a as w}from"./index-D8rVyQy1.js";const T=()=>{const[t,o]=r.useState(null),[d,a]=r.useState(!1),{user:s,dispatch:n}=b(),[c,l]=r.useState(!1);return{deleteAcc:async()=>{var i,g;if(!s)return k.error("User authentication failed. Please log in again.");if(!navigator.onLine)return k.error("You're offline! Check your internet connection and try again.");a(!0),o(null),l(!1);try{const u=await w.delete("https://workoutx-e9dl.onrender.com/api/user/profile",{headers:{Authorization:`Bearer ${s.token}`}});u.status===200&&(n({type:"DELETE"}),l(!0),localStorage.removeItem("user"),k.success(u.data.message||"Your account has been deleted successfully."))}catch(u){const m=((g=(i=u.response)==null?void 0:i.data)==null?void 0:g.message)||"Something went wrong. Please try again.";k.error(m),o(m)}finally{a(!1)}},error:t,isLoading:d,isDeleted:c,setIsDeleted:l}},D=({isDeleting:t,setIsDeleting:o})=>{const{user:d}=b(),a=f(),[s,n]=r.useState(5),[c,l]=r.useState(!1),{deleteAcc:x,isLoading:i,error:g,isDeleted:u,setIsDeleted:m}=T();r.useEffect(()=>{t&&(n(5),l(!1))},[t]),r.useEffect(()=>{if(t&&s>0){const v=setTimeout(()=>n(N=>N-1),1e3);return()=>clearTimeout(v)}else t&&s===0&&l(!0)},[t,s]);const p=async()=>{if(!d){toast.error("You must be logged in to delete your account.");return}localStorage.setItem("pendingDeletion","true"),m(!0)},j=async()=>{m(!1),localStorage.getItem("pendingDeletion")==="true"&&(await x(),localStorage.removeItem("pendingDeletion"),localStorage.removeItem("hasSeenGuide")),a("/signup")},y=()=>{o(!1),l(!1),n(5)};return r.useEffect(()=>{localStorage.getItem("pendingDeletion")==="true"&&x().then(()=>{localStorage.removeItem("pendingDeletion"),localStorage.removeItem("hasSeenGuide"),a("/signup")})},[]),!t&&!u?null:e.jsxs(e.Fragment,{children:[t&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center backdrop-blur-lg bg-black/80 z-10",children:e.jsxs("div",{className:"bg-white sm:w-lg dark:bg-darkSecondary p-6 rounded-lg shadow-lg transition-colors duration-200",children:[e.jsx("h2",{className:"text-center text-2xl font-bold text-blue-900 dark:text-darkTextPrimary",children:"Confirm Delete Account"}),e.jsx("p",{className:"text-lg flex text-justify text-neutral-800 py-3 dark:text-darkTextResult transition-colors duration-200",children:"Are you sure you want to permanently delete your account? All your workouts will be lost, and this action cannot be undone."}),e.jsxs("div",{className:"flex justify-center md:justify-end space-x-4 mt-4",children:[e.jsx("button",{onClick:y,className:"px-4 py-2 text-white dark:text-darkCancelButtonText bg-gray-400 hover:bg-gray-500 dark:bg-darkCancelButton dark:hover:bg-darkCancelButtonHover rounded-lg cursor-pointer transition-colors duration-200",children:"Cancel"}),e.jsx("button",{onClick:p,disabled:!c||i,className:`px-4 py-2 transition-colors duration-200 rounded-lg  
                                ${c&&!i?"bg-red-500 text-white hover:bg-red-600 dark:bg-darkDeleteButton dark:hover:bg-darkDeleteButtonHover cursor-pointer":"bg-neutral-600 w-[100px] text-white dark:text-darkButtonText dark:bg-darkDisabledText cursor-not-allowed"}`,children:i?"Deleting":c?"Confirm":s})]}),g&&e.jsx("p",{className:"w-full p-2 mb-4 text-red-500 dark:text-errorText border bg-red-100 dark:bg-errorBackground rounded-lg mt-4 flex justify-center items-center transition-colors duration-200",children:g})]})}),u&&e.jsx("div",{className:"flex text-center bg-gray-200 dark:bg-darkPrimary w-full pt-5 transition-colors duration-200",children:e.jsx("div",{className:"fixed inset-0 flex items-center justify-center backdrop-blur-md bg-black/80 z-10",children:e.jsxs("div",{className:"sm:w-1/2 w-3/4 bg-white dark:bg-darkSecondary p-6 rounded-lg shadow-lg transition-colors duration-200",children:[e.jsx("h2",{className:"text-2xl font-bold text-blue-900 dark:text-darkTextPrimary",children:"Account Deleted"}),e.jsx("p",{className:"text-lg my-5 text-neutral-800 font-semibold dark:text-darkTextSecondary transition-colors duration-200",children:"Your account has been deleted successfully. We are sad to see you go! :'("}),e.jsx("button",{onClick:j,className:"px-5 bg-green-600 hover:bg-green-500 active:bg-green-600 cursor-pointer text-white p-2 rounded dark:text-ButtonText dark:bg-darkAddButton dark:hover:bg-darkAddButtonHover dark:active:bg-darkAddButton transition-colors duration-200",children:"OK"})]})})})]})},h=({label:t,value:o,setValue:d})=>{const[a,s]=r.useState(!1),[n,c]=r.useState(o),{user:l}=b(),x=()=>{d(n),s(!1)};return e.jsx("div",{className:"flex justify-between items-center mt-4",children:a?e.jsxs("div",{className:"flex",children:[e.jsx("div",{children:e.jsx("strong",{className:"dark:text-darkTextSecondary text-blue-900 text-lg font-bold",children:t})}),e.jsx("div",{children:e.jsx("p",{className:"text-neutral-800 text-lg dark:text-darkTextResult",children:e.jsx("input",{type:"text",value:n,onChange:i=>c(i.target.value),className:"bg-gray-300 dark:bg-darkSecondary p-1 ml-1 rounded-lg dark:text-darkTextPrimary outline-none"})})}),e.jsx("div",{children:e.jsx("button",{onClick:()=>a?x():s(!0),className:"edit-fullName-btn rounded-lg transition-all duration-200 p-1.5 ml-2 text-neutral-200 active:bg-blue-500 hover:bg-blue-600 bg-blue-500 cursor-pointer dark:text-darkButtonText dark:bg-darkEditButton dark:hover:bg-darkEditButtonHover",children:a?"Save":""})})]}):e.jsx("div",{className:"flex",children:e.jsx("div",{children:e.jsxs("p",{className:"text-neutral-800 text-lg dark:text-darkTextResult",children:[e.jsx("strong",{className:"dark:text-darkTextSecondary text-blue-900",children:t}),o]})})})})},A=()=>{const{user:t}=b(),o=f(),[d,a]=r.useState(!1);console.log(t);const[s,n]=r.useState((t==null?void 0:t.fullName)||""),[c,l]=r.useState((t==null?void 0:t.username)||"");return e.jsxs("div",{className:"flex w-full flex-col items-center justify-center bg-neutral-200 dark:bg-darkPrimary text-blue-900 dark:text-darkTextPrimary relative",children:[e.jsx("button",{className:"text-white absolute top-5 left-5 cursor-pointer bg-blue-900 hover:bg-blue-950 dark:bg-darkTertiary dark:hover:bg-darkSecondary rounded-lg p-2",onClick:()=>o("/"),children:"Back"}),e.jsx("h1",{className:"text-3xl font-bold",children:"Profile Page"}),e.jsx("div",{className:"sm:w-1/2 flex justify-center",children:t&&e.jsxs("div",{children:[e.jsx(h,{label:"Full Name: ",value:s,setValue:n}),e.jsx(h,{label:"Username: ",value:c,setValue:l}),e.jsxs("p",{className:"text-neutral-800 text-lg mt-4 dark:text-darkTextResult",children:[e.jsx("strong",{className:"dark:text-darkTextSecondary text-blue-900",children:"Email: "}),t.email]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("p",{className:"text-neutral-800 text-lg mt-4 dark:text-darkTextResult",children:[e.jsx("strong",{className:"dark:text-darkTextSecondary text-blue-900",children:"Plan: "}),t.plan]}),t.plan==="Premium"&&e.jsx(S,{size:20,color:"#FFA500",className:"translate-y-5"})]}),e.jsxs("p",{className:"text-neutral-800 text-lg mt-4 dark:text-darkTextResult",children:[e.jsx("strong",{className:"dark:text-darkTextSecondary text-blue-900",children:"ID: "}),t._id]}),e.jsx("button",{className:`mt-4 delete-workout-btn text-white rounded-lg p-2 cursor-pointer bg-red-500 hover:bg-red-600 \r
                            dark:text-darkButtonText dark:bg-darkDeleteButton dark:hover:bg-darkDeleteButtonHover transition-colors duration-200`,onClick:()=>{console.log("Delete button clicked. Toggling isDeleting:",!d),a(!d)},children:e.jsx("strong",{children:"DELETE ACCOUNT"})})]})}),e.jsx(D,{isDeleting:d,setIsDeleting:a})]})};export{A as default};
